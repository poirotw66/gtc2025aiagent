こんにちは 。 NTT コミュニケーションズ の 、 え 、 継崎 と 申し ます 。 本日 は 大 規模 言語 モデル 学習 スケール の ため の テレコム の ケース と し て 、 え 、 発表 さ せ て いただき ます 。 よろしく どうぞ よろしく お 願い いたし ます 。 この 発表 は 私 、 崎 と 、 え 、 メイン の 首書 で ある 鈴 の 共同 の 発表 と なっ て おり ます 。 前半 の パート に つい て 私 、 豊崎 の 方 から ご 説明 さ せ て いただけれ ば と 思い ます 。 え 、 まず この 発表 で は 、 え この成 に 対する テレコム の アプローチ と し て GPU/ APN と いう もの に つい て ご 紹介 いたし ます 。 GPU/ APN と いう コンセプト は 既存 の GPU リソース を 有効 活用 する ため 、 また 様々 な 社会 課題 を 解決 する ため の 効率 的 な アプローチ で ある と いう 風 に 考え て おり ます 。 また それ ら を 活用 する ため に NVD 社 の 、 え 、 ネモ フレームワーク や メガトロン と いっ た 分散 フレームワーク に つい て 、 え 、 色々 検討 重ね て おり ます の で 、 そう いっ た テクニック アプローチ そして 実際 に は そう いっ た テクニック が 実現 する よう な APN で の 、 え 、 実現 する 実証 実験 の 結果 と いう もの に つい て ご 紹介 できれ ば と いう 風 に 考え て おり ます 。 まず 、 え 、 最初 イントロダクション と し て の 課題 と テレコム の アプローチ に つい て ご 説明 いたし ます 。 近年 、 え 、 ご覧 の 皆 様 も 、 え 、 非常 に 、 え 、 課題 感 を 抱え られ て いる と いう 風 に 思い ます が 、 CS成 AI に つい て GPU の 需要 と いう もの が 非常 に 拡大 し て おり ます 。 特に この 23 年 で 起こっ て いる 生成 ブーム データ 活用 処理 など 多く の 分野 で 、 え 、 NVD 社 の GP を 始め と し た 多く の 計算 資源 が 必要 と なっ て い ます 。 もちろん GPU 自体 は 非常 に パワフル な チップ 、 リソース 、 計算 資源 で は ある もの の 、 こう し た の 需要 に 対し て 今 GPU が 、 え 、 全然 足り て い ない と いう よう な 背景 が あり ます 。 特に 、 え 、 GPU 1 枚 で 計算 できる 、 もちろん GPU 1 枚 は パワフル な 調 距 が できる です けれど も 、 この GPU が 、 え 、 1 枚 で 解決 でき ない 課題 を 解決 する ため に 複数 GPU サーバー を 並べ て 同時 に 使う と いう シーン が 非常 に 拡大 し て おり ます 。 で は 実際 に なぜ そんな に GPU が 必要 な の か と いう こと を 少し だけ 簡単 に ご 説明 いたし ます と 、 昨 、 え 、 ま 、 生成 AI 何か を 聞い たら 回答 し て くれ てる よう な 生成I を 皆 様 思い浮かべる か も しれ ませ ん が 、 そう いっ た AI モデル の 学習 に こう いっ た GPU の よう な 計算 資源 と いう もの が 使わ れる と いう な 背景 が あり ます 。 この AI モデル の 学習 に つい て は 基本 的 に は その モデル AI の 、 え 、 重み と いう もの に 対し て たくさん の データ を 、 え 、 入力 し て その 重み 自体 を 少し ずつ 変更 さ せ て 学習 を さ せ て いく と いう よう な プロセス が 重要 に なっ て き ます 。 一方 で 皆 様 が 感じ て いらっしゃる 通り 生成 AI に つい て は 1 週間 、 2 週間 、 1 ヶ月 と いっ た 非常 に 早い ペース で 、 え 、 世界 が 動い て いる こと も あり 、 より 高 制度 で より 良い プロダクション の モデル と いう もの を 素早く 提供 する 必要 が あり ます 。 ここ で 重要 に なっ て くる の が その モデル を 開発 する より 早く 学習 を 進め たい と いう 要件 に なり ます と 。 で 、 こう いっ た アプローチ を する 際 に は 基本 的 に は 学習 さ せる 大量 の データ と いう の を 、 え 、 複数 に 分割 し 、 複数 の GPU で 同時 に 学習 を 進める こと に よっ て 全体 の 実行 時間 、 モデル に かかる モデル の 開発 に かかる 実行 時間 を 減らす と いう よう な アプローチ が 必要 に なっ て き ます 。 また 昨 の 生成 AI で は 非常 に 巨大 な モデル と いう もの が 出現 し て き て おり ます 。 要件 に 書い た 通り 、 より 大 規模 な モデル を 使い たい 場合 に は 、 例えば ラマ 3.1 の 405ビリオン の パラメーター の モデル に 対し て は 、 え 、 8ビット の 精度 で 405GB ほど あり ます の で 、 今 の 、 え 、 比較 的 新しい ホッパー の 世代 で あっ て も 80GB の デモリ 、 つまり 1 枚 の GP に は 乗ら ない よう な 、 え 、 巨大 な LLM 、 CCI と いう もの が 出現 し て おり ます 。 こう いっ た もの を 学習 する ため に は 、 そもそも 学習 を する ため に 複数 の GPU に この モデル を 分割 し て 学習 する よう な 手法 が 必要 に なっ て くる ため 、 この 要件 2 、 要件 1 を それぞれ 組み合わせ大 な モデル を より 早く 学習 を する 、 そして 市場 に 出し て いく と いう と プロダクション の 観点 から GPU の 需要 が 非常 に 拡大 し て いる と いう な 現実 が あり ます 。 これ に 対し て 、 ま 、 もちろん NTT コミュニケーションズ は 様々 な 、 え 、 ソリューション 、 え 、 あるいは データ センター の よう な ビジネス を 展開 し て いる ん です けれど も 、 単一 の データ センター 、 やはり データ センター を 1 つ 作る に も 非常 に 時間 が かかり ます の で 、 単一 の データ センター で お 客 様 の 需要 に 合う よう な 、 え 、 リソース 、 特に 電源 や 熱量 、 ラック と いっ た もの を 提供 する こと が でき ない と いう もの が 課題 に なり つつ あり ます 。 こう いっ た 時 に 、 え 、 もちろん クラウド の 利用 を 考え られる お 客 様 も いらっしゃる と 思う ん です けれど も 、 クラウド 自体 も 非常 に 大量 の GP を 一ぺ に 、 え 、 取得 する よう な もの が なかなか 難しく なっ て き て おり まし て 、 今 ある それぞれ の データ センター に 分散 し たい よう な GPU の リソース を より 効率 よく 使っ て いく と いう な 、 え 、 現在 出 て き て おり ます 。 これ ら を 解決 する ため に 我々 は GPU APN と いう コンセプト を 打ち出し 、 実際 に これ が 使える ん だ 、 え 、 実際 に この よう な パターン で この よう な 需要 に 答え られる こと が できる ん だ と いう の は な 実証 実験 を 進め て いる と いう の が 本日 の 紹介 に なり ます 。 え 、 この GPN は 昨年 の 10 月 に 、 え 、 プレス リリース で 、 え 、 世界 的 に 報道 さ せ て いただい た と ところ で は ある ん です けれど も 、 今 言っ た よう な 単一 の データ センター の リソース 計算 資源 で は 賄え ない もの を ネットワーク で 、 え 、 APN と いう ネットワーク で つぐ こと に よっ て オンデマンド に GPU リソース を 確保 し 、 こう いっ た 足り ない 計算 資源 を 有効 活用 する と いう こと を コンセプト に し て おり ます 。 この ため 先ほど 、 え 、 ご 紹介 し まし た よう な 、 え 、 分散 学習 に おけ る 課題 、 例えば 従来 の 、 え 、 GPU を 使っ た 、 え 、 AI の 学習 に つい て は 単一 の データ センター 内 で 複数 の GPU サーバー を 使っ て 学習 を 進め て い た もの と いう の を 複数 の データ センター 間 で 余っ て いる GPU リソース を それぞれ 、 え 、 この 間 の Ion APN と いう もの で 繋い で あげる こと に よっ て まるで 1 つ の GPU クラスター か の よう に 使う こと が できんと 効率 よく 学習 を 進め られる と いう こと を 実証 する よう な コンセプト に なっ て おり ます 。 で は 実際 Ion APN と いう の は 何か と いう ところ を 軽く 少し 宣伝 みたい に なる ん です けれど も ご 紹介 さ せ て いただき ます と 、 こちら は です ね 、 我々 NTT グループ が 提供 する 公容量 好 品質 低 電力 の ネットワーク 改正 の サービス に なっ て おり ます と 。 で 、 実際 こちら の IAPN は すでに 、 え 、 昨年 の 3 月 に 、 え 、 提供 を 開始 し て おり まし て 、 お 客 様 から ご 要望 を いただけれ ば 、 え 、 提供 できる よう な もの に なっ て おり ます 。 で 、 実際 この ION APN を 使う こと に よっ て 、 え 、 こう し た GPU APN と いう コンセプト を 、 え 、 皆 様 に ご 提案 し て いる と いう 状況 で ある ん です けれど も 、 我々 は この 、 え 、 ION APA の 単に お 客 様 の ご 要望 の 単点 に 、 え 、 つぐ だけ で は なく て 、 グリーンネッ センター と いう 我々 が 今 建設 中 の 、 え 、 データ センター に 関し て も それぞれ を ION 、 APN で つぐ こと に よっ て 、 お 客 様 が 必要 な 時 に 必要 な ニーズ を 我々 データ センター と ION APN セット で ご 提供 する と いう こと を 、 え 、 目指し て おり ます 。 しかし この GPN 一言 で 、 ま 、 あの 、 すぐ に 実現 でき たら 素晴らしい な と いう 風 な 感想 を 持っ て いただける と 幸い な ん です けれど も 、 なかなか 実際 の 技術 的 な 部分 に つい て は 課題 が ある と いう こと を 我々 は 感じ て おり ます と 。 で 、 実際 に その 課題 を どの よう に 解決 する か と いう の は 、 え 、 この 発表 の 後半 で の 今 に なる ん です けれど も 、 課題 の ところ だけ 簡単 に ご 説明 いたし ます と 、 まず 、 え 、 こう し た 分散 データ センター の コンセプト と いう の は 今 まで なかなか 普及 し て い ない た 背景 も あり 、 どの よう な 分子 学習 フレームワーク を 使う か と いう こと が 非常 に 、 え 、 キー に なり ます 。 特に 、 え 、 最初 に 説明 し た 通り 複数 の GPU サーバー で 、 え 、 分散 し て 学習 と いう よう な コンセプト に なり ます の で 、 この マルチ ノード で スケール する 学習 フレームワーク が へ の 対応 と いう の が 必要 に なり ます 。 こちら NDIA 様 と の パートナーシップ で 、 え 、 この 後 紹介 する で 解決 いたし ます 。 また この 分散 学習 フレームワーク に 対し て 我々 独自 の LM を 持っ て おり ます 。 と いう 独自 の LM も 持っ て おり ます の で 、 こちら に つい て どの よう に 適用 し た か と いう ところ に つい て ご 紹介 いたし ます 。 また ION APN は すでに お 話し し た 通り 品質 で 低円 な ネットワーク だ と いう 風 に 、 え 、 言わ せ て いただい て いる ん です けど も 、 もちろん その 中 で 物理 的 な 限界 と いう の が あり ます の で 、 そう いっ た 部分 の 長 距離 通信 遅延 を どの よう に 解消 し て いく か 、 これ を NVIDIA 様 の GPUダイレト RDMA の 技術 と 組み合わせ て どの よう に 改善 できる か と いっ た こと に つい て この後ご説明させていただければと思っています。
はい。ここからは、え、鈴神の発表します。実際に先ほど鶴から、え、紹介だいた課題に対して、え、分散学習フレームワーク NBIA にもメガトロンで解決したというところについては、え、紹介させていただきます。まず最初にですね、エルミディアにも、え、メガトの概用について説明させてください。え、右 の よう に です ね 、 え 、 中心 と なる もの は です ね 、 緑色 の ところ で 、 え 、 記載 さ れ た メガトロン コア と いう 風 な も もの に なっ て おり ます 。 え 、 こちら は です ね 、 トランスフォーマー の 代 学習 ライブラリー と なっ て おり まし て 、 基本 的 な パト地 ベース で 書か れ て おり まし て 、 基本 的 な アテンション や MLP の ブロック 等 が 、 え 、 記載 さ れ て いる よう な もの に なっ て い ます 。 その 上 に です ね 、 え 、 ニモ や です ね 、 メガトン LM と いっ た よう な です ね 、 学習 実行 の フレームワーク が 、 え 、 存在 し てる よう な 、 え 、 形 と なっ て おり ます 。 この 2 つ の 、 え 、 違い に つい て は です ね 、 段 に 申し ます と え 、 は です ね 、 え 、 アウト オブザボックス で クイック に です ね 、 実行 が 、 え 、 可能 と なる よう な 形 と なっ て おり 、 一方 で です ね 、 メガト の エレメ に 関し て は 自由 度 や カスタマイ 性 が 非常 に 高い もの に なっ て おり ます 。 です の で 、 え 、 クイック に です ね 、 実行 し た 場合 に も 選択 し て 、 え 、 内部 の です ね 、 学習 等 を です ね 、 え 、 カスタム し たい と いう 風 な 場合 は メガトン LM を 選択 する と いう の が 、 え 、 よい 、 良い か な と いう 風 に 思い ます 。 で 、 こちら です ね 、 え 、 ネビデア 2万 メガ を 利用 する メリット に つい て 説明 さ せ て ください 。 え 、 こちら です ね 、 多様 な モデル アーキテクチャー を サポート し てる と いう 点 が まず 、 え 、 大きな 大 前提 と なり ます 。 GPT スタイル の です ね 、 デコード オンリー の もの から です ね 、 AT 5 の エコ 、 エンコーダー 、 デコーダー 、 え 、 もしくは です ね 、 エンコーダー オンリー の バート の よう な もの も です ね 、 え 、 か え 、 サポート さ れ て いる と いう 風 な 形 に なり ます 。 で 、 また です ね 、 学習 の コース も です ね 、 非常 に 大きな ポイント と なっ て おり まし て 、 こちら 、 え 、 ミックス プレッシ の です ね 、 え 、 Bフロット 16 です と か FP8 と いう もの が 、 え 、 サポート さ れ て おり まし て 、 これ に よっ て です ね 、 学習 の 高速 化 や 、 え 、 メモリ 仕様 の 削減 と いっ た ところ が 、 え 、 期待 さ れる よう な 形 と なっ て おり ます 。 また です ね 、 学習 の です ね 、 並列 分散 学習 手法 の サポート も です ね 、 非常 に 充実 し て おり ます 。 そう です ね 、 基本 と なる データ パラレル から です ね 、 パイプライン パラル や 転送 パラル と いう もの が です ね 、 え 、 実装 さ れる よう な 形 と なっ て おり ます 。 で 、 こちら が です ね 、 実際 に どの よう に こう メリット と し て 感じ られる か と 言い ます と 、 右上 の 、 え 、 大協 言語 学習 モデル の です ね 、 学習 地件 の ところ から 引用 さ せ て いただき まし た が 、 え 、 非常 に です ね 、 LLM の 学習 と いう もの は です ね 、 コスト が 、 え 、 かかる よう な もの と なっ て おり まし て 、 これ を です ね 、 え 、 2モ メガトロン の よう な です ね 、 高速 間 の ライブラリー を 使う こと で です ね 、 非常 に コスト 的 な です ね 、 メリット が 大きい と いう 風 な 観点 が 、 え 、 上げ られ ます 。 例 です と 12.3億円 から です ね 、 9.3億円 まで です ね 、 3億円 節約 でき ます よ と いう 風 な もの も です ね 、 え 、 実例 と し て 上がっ て おり ます 。 また です ね 、 下回り の オーケストレート の サポート も です ね 、 え 、 スラム テスト と か クバネス と 、 え 、 サポート さ れ て おり ます 。 また 管理 サービス の です ね 、 1 DB と も 、 え 、 簡単 に です ね 、 連携 する よう な こと が 可能 と なっ て おり ます の で 、 ま 、 非常 に 使い勝手 が 良い か な と いう 風 に 個人 的 に も 非常 に 思っ て い ます 。 で です ね 、 学習 の スケーリング に つい て 実際 に 、 え 、 適用 可能 に つい て も です ね 、 こちら 、 え 、 メガトロン LA の リポジトリー の です ね 、 え 、 ところ に 、 え 、 検証 結果 載っ て おり ます 。 え 、 こちら の 検証 結果 と いたし まし て は 、 GPT の モデル を 使い まし て 、 マルチード に 学習 し た スケーリング の 、 え 、 検証 結果 が 実際 に 掲載 さ れ て おり ます 。 H の です ね 、 GPU が 48 個 を です ね 、 え 、 6144 個 まで です ね 、 実際 に スケーリング さ せ た よう な 、 え 、 結果 が 載っ て おり ます 。 で 、 右 の です ね 、 グラフ の よう に 、 え 、 実際 に こう 想定 さ れる です ね 、 スケーリング と 、 え 、 非常 に こう 色 ない よう な 形 で 実際 の です ね 、 え 、 フロップ ストーン も 、 え 、 追いつい て おり まし て 、 理想 的 に 学習 が スケーリング 可能 で ある と いう ところ も です ね 、 実証 と し て 分かっ て いる と いう 点 が 非常 に ポイント か な と いう 風 に 、 え 、 思い ます 。 で です ね 、 ここ から 、 え 、 紐 を です ね 、 使う と いう 点 に つい て ちょっと 1 点 、 注意 点 が あり ます の で 紹介 さ せ て ください 。 え 、 現在 です ね 、 2025 年 3 月 時点 で です ね 、 え 、 煮 は です ね 、 バージョン と し て 、 え 、 1.0 から です ね 、 2.0 え 、 バージョン が です ね 、 変更 さ れる よう な 転換 機 で ある ため 、 ちょっと ご 注意 が 必要 です 。 え 、 本料 は です ね 、 以降 は 基本 的 に は 2物 です ね 、 2.0 ベース で お 話し さ せ て いただき たい と いう 風 に 思い ます 。 で 、 1.0 と です ね 、 2.0 の 違い に 関し て は です ね 、 大きく 、 え 、 1.0 で は です ね 、 ヤムル ベース の 設定 方法 に なっ て い た もの が です ね 、 2.0 から は です ね 、 Python の コード ベース に 変更 と なっ て おり ます 。 これ に よっ て です ね 、 え 、 ビジュアル スタジオ コード 等 の です ね 、 え 、 もの で サジスト さ れる よう に です ね 、 UX が 非常 に 改善 し た か な と いう 風 に 思い ます 。 右下 の 画像 の よう に です ね 、 実際 に です ね 、 えっ と 、 ラーマ の もの が です ね 、 サスト さ れ て いる か な と 思い ます 。 で 、 また です ね 、 従来 に 比べ て 設定 や カスタマイズ 性 が です ね 、 非常 に こう 綺麗 に 整理 さ れ て いる か な と いう 風 に 思い ます の で 、 開発 試線 と し て も 非常 に 、 え 、 使い やすい もの に なっ て いる か な と いう 風 な 印象 を 受け ます 。 はい 。 で 、 実際 に です ね 、 2.0 で どの よう に です ね 、 LLM の 学習 コード 記載 する か に つい て 説明 明 さ せ て ください 。 え 、 こちら の 右 の です ね 、 学習 コード の 例 の よう に です ね 、 え 、 この よう に 数行 で 実際 に です ね 、 え 、 学習 を 実行 可能 と いう 風 な 形 に なっ て おり ます 。 で 、 全て です ね 、 コード ベース で の 前提 と なっ て おり ます 。 で 、 また です ね 、 え 、 実際 に 実行 する と いっ た 点 に つい て も です ね 、 リモラン と いう な です ね 、 通 が 、 え 、 あり まし て 、 こちら で も です ね 、 え 、 クイック に 実行 する と いう 風 な こと が 、 え 、 可能 に なっ て おり ます 。 え 、 レシピ と いう 形 で です ね 、 主要 な LL モデル 例えば です ね 、 GPT です と か ネモトロン や ラーマー と いっ た よう な もの を です ね 、 え 、 実際 に 、 え 、 簡単 に 学習 が 可能 に なっ て い ます 。 また です ね 、 ツール と し て も コマンド ライン の インターフェース と し て 、 え 、 ネモ LM プレトイン と いっ た よう な 形 で です ね 、 え 、 簡単 に です ね 、 実行 も 可能 に なっ て おり ます 。 で 、 実行 する 環境 に つい て も です ね 、 え 、 エクゼキューター と いう もの を 、 え 、 変更 する こと で 様々 な 実行 関係 で 動作 可能 に なっ て いる 点 も です ね 、 非常 に 魅力 的 か な と 思い ます 。 ま 、 ローカル を 初め と し て です ね 、 例えば 、 え 、 え 、 スラム です と か 、 あと スカイ パイロット と 呼ば れる です ね 、 インフラ の 重傷化 レイヤー で あり ます ところ で です ね 、 クネテス で あり まし たり 、 ま 、 え 、 クラウド 上 で の 実行 と いう もの が できる か な と いう 風 に 思い ます 。 はい 。 で 、 ここ から です ね 、 冒頭 で も 、 え 、 述べ させ て いただい た よう に 独自 アーキテクチャー を です ね 、 実際 に 紐 で です ね 、 どの よう に 継続 事前 学習 する か と いう 点 を です ね 、 え 、 ステップ コード に 分け て です ね 、 え 、 紹介 さ せ て いただけれ ば と いう 風 に 思い ます 。 はい 。 で 、 全体 の ステップ は です ね この よう に なっ て おり まし て 、 最初 、 ま 、 データ セット の 準備 から です ね 、 え 、 実際 に 独自 アーキテクチャー 等 です ね 、 どの よう に 、 え 、 根モ で です ね 、 え 、 実装 する の か と いっ た 点 を 、 え 、 踏まえ まし て 、 え 、 実際 に です ね 、 ある 、 え 、 モデル を です ね の パラメーター を インポート し て 継続 的 に 事前 学習 する と いう 方法 と 実際 に です ね 、 ニモ 上 で 、 え 、 並列 分散 学習 の です ね 、 え 、 パイプライン パレル です と か 点差 パレット を 設定 し て 学習 を 実行 する と いう 風 な 、 え 、 形 に なっ て 、 え 、 おり ます 。 はい 。 まず 最初 に です ね 、 え 、 データ セット の 準備 に つい て 説明 さ せ て ください 。 え 、 実際 に です ね 、 2モ で 、 え 、 学習 する 場合 は です ね 、 え 、 データ を JON L 形式 で 、 え 、 名 を テキスト と し て です ね 、 この VALU に 学習 データ 、 え 、 実際 に です ね 、 今日 は とても 晴れ て い ます ね と いう 風 な 、 え 、 文章 で あり まし たり 、 そう いっ た もの を 、 え 、 設定 する よう な 形 と なり ます 。 で 、 この です ね 、 え 、 データ セット 自体 を です ね 、 え 、 前 処理 する 必要 が あり い ます 。 で 、 その 前 処理 の です ね 、 え 、 形 に つい て も です ね 、 2 の です ね 、 コンテナー を まず 実行 いたし まし て 、 そこ から です ね 、 プリセス データ forメガトン と いう です ね 、 スクリプト が あり ます の で 、 こちら で 実行 し ます 。 え 、 事前 に です ね 、 独自 モデル の トークナイザー を です ね 、 用意 する と いう 風 な 形 で 、 え 、 トーク内 の ライバル が 例えば です ね 、 えっ と 、 ファギング ヘイス 形式 の もの で あれ ば この タイプ に です ね 、 実際 に 、 え 、 独自 モデル の 場合 は です ね 、 ローカ の パスト を 指定 し て 、 え 、 設定 いたし ます 。 で 、 そう し ます と 前 処理 後 の データ です ね 、 え 、 ドバ binary と idx と いう よう な 形 で 、 え 、 マ処理 後 の データ セット が 必要 さ れ ます の で 、 これ を 実際 に 学習 と し て 利用 する 、 え 、 形 と なり ます 。 で 、 次 に です ね 、 実際 に 、 え 、 モデル を 実装 する と いう ところ に つい て 説明 いたし ます 。 え 、 一般 的 な です ね 、 昨こ の こう LLM の です ね 、 デコード オンリー モデル の 場合 は です ね 、 例えば 、 え 、 右図 の です ね 、 え 、 え 、 ラーマ 実装 の よう に です ね 、 各種 パラメーター 等 を 調整 する だけ で 、 え 、 非常 に です ね 、 簡単 に 、 え 、 実装 する よう な 、 え 、 こと が 可能 に なっ て おり ます 。 例えば です ね 、 え 、 モデル 内 です ね 、 ノバゼーション で あっ たり 、 アクティベーション の ファンク を です ね 、 え 、 実際 に 調整 を し たり です と か 、 あと は こう ヒン サイズ を こう 実際 に 調整 する です と か 、 ま 、 そう いっ た もの を 、 え 、 する だけ で です ね 、 え 、 一般 的 な 、 え 、 デコ オンリー の モデル は 、 え 、 その まま 、 え 、 動く よう な もの が 実装 可能 と なっ て おり ます 。 で 、 イメージ と し て は です ね 、 例えば ファギング フェイス モデル を です ね 、 え 、 ネモ で 動かす と いっ た よう な こと を 考える と ファギング Faceス 形式 の こうコン confン .jon jソon の です ね 、 設定 値 と 、 え 、 こちら 、 え 、 の 、 え 、 根元 です ね 、 コンフィグ を です ね 、 ニラメっこし て 合わせ て いく よう な 形 で 、 え 、 調整 が 可能 と なっ て おり ます 。 で 、 設定 可能 な パラメーター 一覧 は です ね 、 え 、 元 の です ね 、 メガトロン コア の 方 で 、 え 、 記載 さ れ て おり ます トランスフォーマー コンフィグ で あり ます と か 、 え 、 モデル パラレル コンフィグ 等 を 、 え 、 設定 確認 し て 実際 に 合わせ て いく と いう 風 な 形 と なっ て おり ます 。 で 、 え 、 こちら の よう に です ね 、 一般 的 な デコ通り の 問題 で の もの は 、 え 、 説明 し た ようり 、 え 、 パラメーター を 調整 する だけ で です ね 、 え 、 非常 に 簡単 に 実装 できる の です が 、 そう で ない ケース も もちろん あり ます 。 で 、 その ケース も です ね 、 え 、 紐 2 で は です ね 、 サポート さ れ て おり ます 。 例えば です ね 、 ファルコン モデル の よう な 、 え 、 形 の 場合 は です ね 、 え 、 メガトロン コア で です ね 、 えっ と 、 カスタム モデル を 実際 に 自分 で 実装 する と いう 風 な 、 え 、 形 に なり い ます 。 え 、 カスタム モデル スペック と 言わ れる ところ で は です ね 、 実際 に 使用 する モデル の です ね 、 モジュール 等 を 、 え 、 設定 し て です ね 、 え 、 変更 する 形 と なり ます 。 で 、 変更 し た 、 え 、 モジュール 等 を 利用 し て 実際 に フォワード 処理 が どの よう に 走る か と いう ところ も 、 え 、 実装 する 形 で 、 え 、 独自 アーキテクチャー の LLM と いう もの を です ね 、 え 、 実装 し て いく 流れ と なっ て おり ます 。 はい 。 で 、 実際 に です ね 、 え 、 今 ある 既存 の LL モデル の です ね 、 パラメーター を インポート する 処理 に つい て 説明 さ せ て いただき ます 。 え 、 こちら の です ね 、 IO 、 え 、 モデル コネクター と いう もの を です ね 、 継承 し た 、 え 、 インポーター を 作成 する よう な 形 と なっ て おり ます 。 こちら の 例 で は ラマー 形式 を です ね 、 対処 と し て 説明 いたし ます 。 で 、 まず です ね 、 最初 1 番 目 に ある よう に 、 え 、 ファギング ヘイス 形式 の です ね 、 えっ と 、 ラーマー の モデル から です ね 、 根モデル に 、 え 、 変換 する と いう こと を 、 え 、 考え ます と 、 ま 、 この よう な 形式 で 、 え 、 モデル インポーター 等 を です ね 、 え 、 実装 し て いく よう な 、 え 、 形 と なっ て おり ます 。 で 、 実際 に です ね 、 え 、 パラメーター です ね 、 パイチ の 、 え 、 ステートディクト の です ね 、 キー を です ね 、 え 、 HF の 形式 から 、 ま 、 ネモ で 使用 する 形式 に 、 えっ と 、 マッピング を 作成 し て 適用 し て いく よう な 、 え 、 形 と なっ て おり ます 。 左 が です ね 、 ファイニング ヘース 形式 で 、 右 が 根物 です ね 、 え 、 キー に 対応 し て おり ます 。 それぞれ リクト と し て この マッピング を 作成 し て 変換 し て いく よう な 、 え 、 形 と なっ て おり ます 。 で です ね 単純 に 2 ネーム だけ で は 対応 でき ない と いう 、 え 、 ケース が あり ます の で 、 その 場合 は です ね 、 変換 関数 を 追加 で 、 え 、 実装 する と いう 風 な 流れ と なっ て おり ます 。 例えば こちら の 例 です の よう な もの に なる の です が 、 え 、 統地 の です ね 、 コンカテネ等 を 利用 し て 、 え 、 実際 に 煮 で 、 え 、 使う よう な 形式 に 変換 し て 、 え 、 継続 的 に です ね 、 パラメーター を 、 え 、 学習 する と いう の が 可能 と なっ て おり ます 。 はい 。 で 、 最後 に です ね 、 え 、 ニモデ 学 を 実行 する 場合 は です ね 、 先ほど 実装 し た インポーター を です ね 、 利用 する の で 、 え 、 インポート です ね 、 チェックポイント 関数 と いう もの を 、 え 、 実行 し て 既存 の です ね 、 例えば ファギング フェイス モデル を です ね 、 根物 形式 に 、 え 、 変換 いたし ます 。 で 、 そう し て です ね 、 トレーナー の 、 え 、 チェックポイント に です ね 、 変換 し た ネモ モデル を です ね 、 指定 し て 、 え 、 やる こと です ね 、 継続 的 な 、 え 、 事前 学習 が 実行 可能 と いう 風 な 、 え 、 形 と なっ て おり ます 。 で 、 また 補足 そして です ね 、 根元 で です ね 、 え 、 分散 系 並列 学習 手法 を 利用 する 場合 は この です ね 、 え 、 メガトロン ストラテジー と いう もの を 利用 いたし まし て 、 え 、 ストラテジー を 設定 し て パラル と か 、 え 、 パイプライン パラル の 値 を 設定 いたし ます 。 また プレシジョン も です ね 、 え 、 メガトンミクスプレシン と いう の を 使っ て です ね 、 こちら です と BF 16 の です ね 、 設定 を し て 、 え 、 実際 に 学習 が 、 え 、 可能 と なる と いう 風 な 形 と なっ て い ます 。 はい 。 で 、 ここ から です ね 、 実際 に こう え 、 冒頭 述べ た GPO AP の 課題 の 長 距離 の 、 え 、 通信 に つい て の 、 え 、 NCCA の チップス に つい て 、 え 、 ご 紹介 いたし ます 。 はい 。 まず NCCA と は です ね 、 え 、 NBIDIA コレクティブ コミュニケーション ライブライ と なっ て おり まし て 、 え 、 マルチ GPU の です ね 、 デファクト な 通信 ライブラリー と いう 風 な もの に なっ て おり ます 。 え 、 こちら は です ね 、 分散 学習 で 利用 さ れる オールデリス 等 の 通信 は です ね 、 この ライブラリー で 、 え 、 実装 さ れる よう な 、 え 、 形 と なっ て おり ます 。 え 、 インフィニ バンド です と か イサネット や 、 え 、 NVリンク 、 NVイtッチ 等 で です ね の 利用 で 最適 な 経路 等 が 、 え 、 設定 さ れ て 実際 に 、 え 、 マルチ度 感 の です ね 、 高速 な 通信 と いう もの が 、 え 、 この ライブラ に よっ て 実現 する と いう 風 な 、 え 、 もの に なっ て おり ます 。 で 、 予備 実験 と いたし まし て 実際 に 長距 で です ね 、 どの よう な パラメーター を 、 え 、 変更 すれ ば です ね 、 え 、 効果 が 出る の か と いう ところ を です ね 、 え 、 検証 いたし まし た 。 はい 。 え 、 環境 と し て は です ね 、 え 、 秋葉原 と 三鷹 の です ね 、 約 40km を です ね 、 我々 の 、 え 、 i APN 等 で 、 え 、 接続 し た 、 え 、 環境 と なっ て おり ます 。 え 、 実験 内容 と し て は です ね 、 え 、 RDM の パフォーマンス ツール で ある IBL BW と 、 え 、 利用 し て 測定 を いたし まし た 。 で 、 ここ で は です ね 、 長 距離 RDMA に おけ る パラメーター の 、 え 、 です ね 、 メッセージ サイズ と です ね 、 もう 1 つ こう QP サイズ 、 え 、 Qペア サイズ の です ね 、 え 、 もの を です ね 、 調査 いたし ます 。 で 、 左 の です ね 、 グラフ が 、 え 、 横軸 が です ね 、 メッセージ サイズ を 変更 さ せ た もの に なっ て い まし て 、 縦軸 が 、 え 、 スルー プット と なっ て おり ます 。 まず 最初 に です ね 、 メッセージ サイズ を 変更 する 、 増加 さ せる こと に よっ て です ね 、 え 、 1度 に 通信 を する 量 が 、 え 、 増え ます の で 、 遅延 の 影響 と いう もの が 、 え 、 非常 に です ね 、 え 、 解消 さ れる と いう 風 な 結果 と なっ て おり まし て 、 実際 に 100GBS 程度 の です ね 、 値 が 出る よう な こと が 確認 でき まし た 。 はい 。 で 、 右 の です ね 、 QP サイズ の 変更 に つい て も 、 え 、 調査 いたし まし て 、 QP サイズ を です ね 、 増加 さ せる こと に より まし て 、 え 、 通信 の 多重化 と いう もの が 、 え 、 可能 と なる と 思わ れ ます の で 、 え 、 実際 に です ね 、 え 、 遅延 差 に つい て は 多重 化 さ せる こと で です ね 、 え 、 通信 の スループ と いう もの が 向上 さ せる と いう こと を 確認 いたし まし た 。 で 、 ここ から です ね 、 え 、 RDMA に おけ です ね 、 メッセージ サイズ 、 QP サイズ の 増加 が です ね 、 え 、 長 距離 に 、 え 、 大きく こう です ね スループ と 向上 に 木 を する と いう こと が 分かり まし た の で 、 え 、 これ を 踏まえ まし て 、 え 、 ニッケル の です ね 、 改善 ポイント 等 も 、 え 、 こちら で 検証 し て おり ます 。 え 、 アキャバ と です ね 、 三鷹間 、 え 、 先ほど の 環境 で 、 え 、 IB の です ね 、 え 、 結果 を 踏まえ て ニケル で 関連 性 の ある パラメーター の 影響 を 、 え 、 検証 し た と いう 風 な 、 え 、 もの に なっ て おり ます 。 で 、 事件 内容 と し て は NCCA テスト 利用 いたし まし て 、 ニッケル に おけ る です ね 、 先ほど の メッセージ サイズ と 関連 の ある 、 え 、 ニッケル バッファー サイズ と いう です ね 、 パラメーター と QP サイズ と 関連 が ある 、 え 、 ニッケル IB QPS コネクション 、 QP 、 え 、 コネクション ごと の です ね 、 QP サイズ を 変える と いう パラメーター を 、 え 、 変化 し て 調査 いたし まし た 。 で 、 左 が です ね 、 日経 の バッファー サイズ を 変更 さ せ た 、 え 、 例 と なっ て おり まし て 、 え 、 こちら は です ね 、 バッファー サイズ を 、 え 、 増加 さ せる こと に よっ て 実際 に 日経 テスト も です の です ね 、 スループ とも 向上 する と いう こと を 、 え 、 確認 いたし まし た 。 で 、 また です ね 、 QP サイズ と 変更 と 関連 が ある 、 え 、 NKL IB QPSパ コネクション も です ね 、 右図 の よう に 、 え 、 変化 さ せ て 増加 さ せ て いき ます と 、 実際 に 日経 テスト で の 、 え 、 スルー プット も です ね 、 向上 する と いう 風 な こと が 、 え 、 確認 でき まし た 。 え 、 この よう に です ね 、 長期 IDM に おけ る 、 え 、 日経 です ね 、 スループット 工場 と いう の です ね 、 え 、 パラメーター 変更 する こと で 、 え 、 向上 する と いう こと を 確認 いたし まし た 。 これ これ ら の 結果 を 踏まえ て 実際 に LL の 学習 で も です ね 、 適用 さ せ て いき まし て スリルプット 向上 を 、 え 、 改善 し た と いう 風 な 、 え 、 もの に なっ て おり ます 。 で 、 ここ から が です ね 、 実際 の 、 え 、 レルメ の 実証 実験 の 結果 に つい て 報告 し たい と いう 風 に 思い ます 。 こちら が です ね 、 GP の 実行 環境 と なっ て おり ます 。 左 から です ね 、 え 、 データ センター の 川崎 、 秋葉原 、 三鷹 を 設定 し て おり ます 。 え 、 川崎 と です ね 、 秋葉原 間 は です ね 、 約 25km の 、 え 、 距離 と なっ て おり ます 。 秋葉原 と 三鷹 間 は です ね 、 約 40km の 、 え 、 距離 と なっ て おり ます 。 それ で です ね 、 i AP の 100GBS の 回線 で 、 え 、 繋い だ と いう 風 な 形 に なっ て おり ます 。 で 、 まず 最初 に です ね 、 2 拠点 で 分散 し た 場合 の 、 え 、 結果 に つい て 報告 し たい と 思い ます 。 え 、 秋葉原 間 の です ね 、 え 、 単出 データ センター 内 の この 黒色 の 、 え 、 矢印 の です ね 、 通信 と です ね 、 秋葉原 三鷹 間 の です ね 、 APN の 通信 と いう もの を 、 え 、 比較 し た よう な 、 え 、 形 と なっ て おり ます 。 はい 。 で 、 こちら が ね 、 です ね 、 2 拠点 に 分散 さ せ た 、 え 、 結果 と なっ て おり ます 。 え 、 我々 の 弊社 の です ね 、 独自 の 、 え 、 レーレム アーキテクチャー で ある 、 え 、 つ の です ね 、 7 ビリオン の 事前 学習 を 用い て 検証 いたし まし た 。 NBA の です ね 、 H 、 え 、 2 台 使っ た 、 エノード で です ね 、 え 、 実施 し て おり ます 。 で 、 え 、 処理 完了 の です ね 、 所用 時間 を です ね 、 実際 に 計測 し て 、 え 、 その 日 を です ね 、 比較 し た と いう 風 な 形 と なっ て おり ます 。 え 、 秋葉 内 で 止め た です ね 、 単位 データ センター の 通信 と 、 え 、 秋葉原三鷹間 の です ね 、 え 、 分散 データ センター 、 AP の 経由 し た 、 え 、 もの と です ね 、 え 、 分散 データ センター の 比較 と し て 、 え 、 実際 に APN の 区間 の ところ です ね 、 インターネット 総点 の TCP の 通信 と し て 、 え 、 置き換え た もの の 3 者 で 、 え 、 比較 を し て おり ます 。 え 、 大質 データ センター の です ね 、 学習 の 所用時 間 を 1 と し た 場合 です ね 、 え 、 分散 データ センター 我々 の です ね 、 提出 GP の です ね 、 え 、 学習 時間 は 約 1.005 倍 と いう 風 な 形 で ほぼ ほぼ 、 え 、 互角 用 の よう な です ね 、 え 、 性能 で です ね 、 え 、 学習 する と いう ところ が 、 え 、 検証 結果 と し て 分かっ て おり ます 。 で 、 また 一方 です ね 、 え 、 APN の 部分 です ね 、 インターネット 想定 の です ね 、 待機 制限 を 、 え 、 かけ た です ね 、 え 、 TCP 通信 と 比較 いたし ます と 、 え 、 約 です ね 、 4. 7 倍 と いう 風 な 形 で です ね 、 やはり 、 え 、 この 、 え 、 実際 に です ね 、 データ センター 化 を つぐ 通信 の 品質 と いう もの が です ね 、 え 、 GP の よう な ケース で は 非常 に こう 重要 に なっ て くる と いっ た よう な もの が です ね 、 分かる か な と いう 風 に 、 え 、 思い ます 。 え 、 続い て は です ね 、 え 、 先ほど の 2 拠点 から 3 拠点 に 、 え 、 分散 さ せ た よう な です ね 、 え 、 結果 を 紹介 さ せ て いただき ます 。 え 、 1 拠点 内 の 単熱 データ センター の 通信 は です ね 、 左側 に あり ます 川崎 機内 で です ね 、 え 、 実際 に H 100 、 え 、 2 期 を です ね 、 3度 に 分け て 、 え 、 実験 いたし まし た 。 で 、 一方 です ね 、 GP に つい て は 、 え 、 川崎 、 秋葉原 、 三鷹 間 の です ね 、 それぞれ 、 え 、 3 拠点 を です ね 、 え 、 APN で 繋い だ もの で 、 え 、 実験 し た と いう 風 な 、 え 、 形 と なっ て おり ます 。 はい 。 で 、 こちら が です ね 、 自称 結果 と なっ て おり ます 。 先ほど の 日拠点 と 同様 に です ね 、 え 、 我々 の 、 え 、 つみ ナビリオン の です ね 、 事前 各種 を 用い て 、 え 、 検証 し た と いう 風 な 、 え 、 形 と なっ て おり ます 。 で 、 こちら も です ね 、 単一 データ センター の 学習 の 所用 時間 を 1 と し た 場合 です ね 、 え 、 分散 データ センター 、 GPOP の 結果 は です ね 、 約 1.1 倍 と ほぼ ほぼ 互角 の よう な です ね 、 結果 が 、 え 、 得 られ まし た 。 で 、 一方 です ね 、 え 、 この APN の 通信 部分 を インターネット 送定 の TCP と し て 、 え 、 置き換え た 場合 は です ね 、 約 9.2 倍 の 、 え 、 時間 が かかる と いう こと 。 で です ね 、 非常 に Ion APN の です ね 、 え 、 品質 な で 定遅延 な です ね 、 え 、 通信 と いう もの が 、 え 、 重要 に なっ て くる か な と いう 風 に 、 え 、 思い ます 。 はい 。 で 、 最後 に です ね 、 え 、 まとめ させ て いただけれ ば と いう 風 に 思い ます 。 我々 、 え 、 本 発表 で です ね 、 GPA AP に よる 、 え 、 分散 データ センター に つい て 、 え 、 紹介 提案 さ せ て いただき まし た 。 え 、 実証 に おい て です ね 、 え 、 ION AP の 、 え 、 高速 で 大容量 低 チェン の 特徴 を 生かし て 、 え 、 分散 データ センター の です ね 、 実用 性 や 有要 性 が 、 え 、 確認 でき た か な と いう 風 に 、 え 、 思い ます 。 え 、 GPU クラスター は です ね 、 複数 の 、 え 、 データ センター に 分散 配置 する こと で です ね 、 単一 の です ね 、 例えば 、 え 、 電源 設備 です と か 土地 の よう な です ね 、 制約 の 問題 や 課題 を 解決 し て 、 え 、 柔軟 かつ 効率 的 に リソース を 利用 する と いう 風 な こと が 、 え 、 できる か な と いう 風 に 思い ます 。 で 、 また です ね 、 今回 利用 さ せ て いただき まし た Nia のsi 、 え 、 ソフトウェア ストック 、 え 、 ニモヤ 、 メガトロン 、 ニッケル の よう な です ね 、 もの を 使い まし て 、 え 、 大 規模 で マルチ 学習 に おけ る スケーラビリティ を です ね 、 今回 確認 でき た か な と いう 風 に 思い ます 。 で 、 また です ね 、 荷物 を 使い まし て 、 独自 の アーキテクチャー で ある LLM の 実装 と です ね 、 実際 に こう 継続 事前 学費 を 行う と いっ た よう な プロセス も 含め て 非常 に です ね 、 え 、 クイック に でき た か な と いう 風 に 、 え 、 思い まし た 。 はい 。 で です ね ね 、 アウトザボックス で 、 え 、 簡単 に です ね 、 CSI を 実行 できる と いう 点 は です ね 、 非常 に 魅力 的 か な と いう 風 に 、 え 、 思い まし た 。 以上 で です ね 、 え 、 本 発表 終わり に し たい と 思い ます 。 ありがとう ござい まし た 。